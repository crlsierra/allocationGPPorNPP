

*In this manuscript, Sierra et al. proposed that carbon allocation should be from GPP instead of NPP in ecosystem models since NPP-based models assumed autotrophic respiration only consumed fixed carbon immediately without transit time. They introduced the conceptual development of carbon allocation from NPP, reviewed 18 ecosystem models, and analyzed the distributions of carbon transit time between the two types of modeling schemes. The authors also showed that the NPP-based model conflicted with empirical evidence on plants' age of respired carbon. Overall, I enjoyed reading this paper. The logic of the manuscript is clear, and the presentation of the ideas and perspectives is precise and neat. I agree with the authors that there are many advantages to modeling carbon allocation from GPP. From a modeler's perspective, I found that some statements in the current version of the manuscript may need more discussion. From the perspective of an empirical ecologist, there are still some limitations to using GPP instead of NPP for carbon allocation. Please find my major and specific comments below.*

We thank the reviewer for the accurate description of our manuscript. We followed the recommendations provided in a revised version, trying to balance the modeling challenges with the available observations.

*Major comments:*
*GPP and carbon allocation are simulated with different time steps in many process-based ecosystem models. For example, GPP is commonly simulated during the daytime with a time step from half to three hours, but carbon allocation is updated daily. If the models adopted the GPP-based carbon allocation scheme, they have to improve the representations of diurnal changes in many processes related to plant growth and carbon allocation. These improvements could dramatically increase the complexity of the canopy module in the model. Some additional discussions on this issue could help modelers better understand the challenge of adopting the GPP-based carbon allocation scheme.*
Thanks for the suggestion. We mentioned the differences in time-steps among the different processes involved, but didn't mentioned the challenges for representing allocation at a timescale compatible with the representation of GPP. To address this issue, we added a paragraph in section 2.2 adding more detail on these time-step differences, and discussed this challenge in the recommendations section.

*Figure 1 showed a constant Ra/GPP ratio in most CMIP Earth system models. This pattern has also been reported in terrestrial ecosystem models (e.g., https://doi.org/10.1002/2016JG003384). As mentioned by the authors, a critical question is how to improve the modeling of autotrophic respiration in the models. Unlike leaf photosynthesis, the Ra scheme varies greatly among current ecosystem models. For example, in the CLM4.5 model, the growth respiration (Rg) is calculated as a factor of the total carbon in new growth on a given timestep, based on construction costs for a range of woody and non-woody tissues. The maintenance respiration (Rm) in CLM4.5 is a temperature function based on a base rate of Rm. However, in the JULES model, Rm is simulated from a moisture and nitrogen function based on dark leaf respiration. Rg in JULES is further calculated as a fraction of the difference between GPP and Rm. The authors have reviewed Rm in different models in section 2.1. It would be better if they could provide some details of the modeling of Ra in some specific models.*
Reviewer 1 correctly pointed out that the pattern presented in Figure 1 emerges by aggregating the data globally, but in fact most models represent a dynamic allocation pattern. However, we would like to point out that the emphasis of our analysis is not that allocation is a constant proportion of GPP. This has been shown in other analysis as in the reference provided by Reviewer 2. The emphasis of our analysis is in the source of the carbon used for allocation, independent on whether allocation is a constant fraction of GPP. Therefore, we decided to reduce the emphasis in the text on this aspect, and give more relevance to the source of carbon for allocation.

We like the suggestion of the reviewer of giving more detail on how some models represent carbon allocation. Although we do not want to give the impression that one or two models are representative of the allocation schemes of all models, we try to give some more details on CLM4.5 as suggested by the reviewer.

*I agree with the authors that ecosystem models need to incorporate the non-structural carbon (NSC) pool dynamics. Adding the NSC pool into the equation (1) or (2) could affect the solution of carbon transit time because it changed the pool-flux structure in fig. 2. I'd like to suggest the authors discuss whether and how adding the NSC pool can influence the distributions of carbon transit time. Also, if we have enough data to parameterize the age of the NSC pool in the models?*
As suggested by the reviewer, we added a section discussing in more detail the addition of a non-structural carbon pool. In particular, we make reference to some of our previous work here (Trumbore et al. 2017, Ceballos et al. 2018, Herrera et al. 2020) where we modeled a NSC pool with an associated distribution of carbon age. This previous work shows that NSCs used for allocation and respiration can have ages as old as a decade. The NSC reserves can support metabolism during periods of no or little photosynthetic inputs, so they play an important role for representing potential threats due to droughts and extreme events. The distribution of ages for the NSC compartment helps to explain observed ages in respired CO2, and can be used to constrain parameters of specific allocation functions in models. However, the number of available observations of ages in NSCs and respired CO2 are still very low, but we hope that more studies will report them in the future, hopefully motivated by what we discuss in this manuscript.

*There are some benefits to using NPP-based carbon allocation, especially in global models. First, the NPP-based scheme consists of more measurable parameters than the GPP-based scheme. The increasing observations of plant traits can be helpful in constraining those parameters. This advantage could be important for those non-woody ecosystems, in which the carbon allocation can be approximated by the annual growth of different plant tissues. Second, because the GPP-based scheme may need to increase the complexity of the canopy process, the computation cost could increase dramatically for data assimilation. Third, GPP itself is unmeasurable, so that the GPP uncertainty could propagate to the carbon allocation.*
Reviewer 1 had a similar opinion on the observability of GPP and the increase in complexity in GPP-based schemes. Again, we believe both GPP and NPP are extremely difficult to measure and there is no single approach that can provide accurate estimates of both variables. Available measurements of NPP only make a crude approximation of the many different components that are often not measured (Clark et al 2001). With the new generation of GPP products such as those provided by Fluxcom, a wealth of information is now available on GPP at the global scale.
Nevertheless, we understand the concern that many available observations on traits may not be used if there is a change to allocation based on GPP.  We think this concern can be reduced if traits such as allometric relations are used in the development of new allocation functions. For instance, the Allometrically Constrained Growth and Carbon Allocation (ACGCA) model proposed by Ogle & Pacala (2009) allocates carbon from GPP, has NSC pools to store carbon before allocation and respiration, and uses allometric constrains to obtain biomass growth. This modeling approach, or a variant of it, would be a good candidate for implementing in new GPP-based schemes.  

*I also agree with the authors that radiocarbon data is helpful for improving the model. However, the measurements of radiocarbon are expensive in many countries. Maybe some introductions or discussions of available radiocarbon data from the ISRaD database are helpful for the readers.*
We added more discussion on the use of radiocarbon. Although radiocarbon measurements are indeed expensive, they are now being collected more often and in many more studies as previously. One main development in the previous years has been the introduction of the Mini radioCarbon Dating System (Micadas), which has reduced the costs and sample throughput in many laboratories around the world.
Unfortunately, the International Soil Radiocarbon Database (ISRaD) only contains radiocarbon measurements from soils, and does not include measurements from plant parts and their respiration flux. However, there is potential that in the future a radiocarbon database for plants becomes available.

*Minor comments:*
*(1) It is better to give basic information about the function faj(Ï„) as described in Metzler et al. (2018). Some new readers could be unfamiliar with the matrix equation and its solution.*
We added more details on this equation as suggested by the reviewer.

*(2) Fig.1: Please add a few sentences to briefly describe those Earth system models.*
We added a few more description of the models.

*(3) P13, L253-254: This statement might be too strong.*
It may be strong but it is true. A NPP-based model cannot use radiocarbon data for model-data assimilation.

*(4) The word "model" is used in different ways in the main text, such as ecosystem model, ecosystem carbon model, coupled carbon-climate model, land-surface model, carbon allocation model, etc. It is better to reduce the diversity of model types in the text.*
Thanks for the suggestion. We adopted only one single description of model, ecosystem carbon model, and made more specific descriptions according to the context.
